Microsoft Windows [Version 10.0.19043.1348]
(c) Корпорация Майкрософт (Microsoft Corporation). Все права защищены.

C:\Users\Данил>mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 19
Server version: 8.0.26 MySQL Community Server - GPL

Copyright (c) 2000, 2021, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> USE `airbnb`;
Database changed

--Вызов процедуры--
mysql> CALL `get_housing_details`;
+----------------------------------------------------+----------------------------------------------------------------------------------+--------------------------+---------------+-------------------+-------------------+
| housing_title                                      | living_comfort_type                                                              | characteristic           | beds_quantity | bedrooms_quantity | bathroom_quantity |
+----------------------------------------------------+----------------------------------------------------------------------------------+--------------------------+---------------+-------------------+-------------------+
| Vivi un sogno nella camera Deluxe                  | Фен                                                                              | Ванная                   |             1 |                 1 |                 1 |
| Роскошное жилье                                    | Wi-Fi                                                                            | Интернет и рабочее место |             5 |                10 |                 5 |
| Rotative micro cabin                               | Предметы первой необходимости: Полотенца, простыни, мыло и туалетная бумага      | Спальня и прачечная      |             1 |                 1 |                 1 |
| The Arctic Hideaway - Lower tall pod -1 single bed | Телевизор                                                                        | Развлечения              |             1 |                 1 |                 1 |
| ???                                                | Стиральная машина                                                                | Спальня и прачечная      |             1 |                 1 |                 1 |
| Sleeping in a suitcase - a unique work of art      | Фен                                                                              | Ванная                   |             1 |                 1 |                 2 |
| Cabane Drommen - L'Arbre ? Cabane                  | Горячая вода                                                                     | Ванная                   |             1 |                 1 |                 0 |
| Acropolis view penthouse w/ private plunge pool    | Стиральная машина                                                                | Спальня и прачечная      |             2 |                 3 |                 2 |
| Family House                                       | Всё необходимое для приготовления еды: Кастрюли, сковородки, масло, соль и перец | Кухня и столовая         |             1 |                 3 |                 2 |
| Trulli della rondine                               | Складная/дорожная кроватка                                                       | Семья                    |             4 |                 4 |                 3 |
+----------------------------------------------------+----------------------------------------------------------------------------------+--------------------------+---------------+-------------------+-------------------+
10 rows in set (0.00 sec)

Query OK, 0 rows affected (0.08 sec)

--Использование функции--
mysql> SELECT (SELECT CONCAT(`lastname`," ", `firstname`) FROM `users` WHERE `users`.id = `housing`.user_id) AS `renter`, `housing`.title AS `title`,`housing_types`.title AS `housing_type`, CONCAT(`location_country`, ", ", `location_city`, ", ", `address`) AS `full_address`, (SELECT CONCAT(`lastname`," ", `firstname`) FROM `users` WHERE `users`.id = `orders`.user_id) AS `client`, `guests_quantity`, `day_quantity`, `price_per_day`, `total_price_without_bonus`, IF(`bonus_amount` IS NULL, 0, `bonus_amount`) AS `bonus_amount`, `total_price`,`orders`.status AS `status`, `paid_amount` FROM `orders` INNER JOIN `housing` ON `orders`.housing_id = `housing`.id INNER JOIN `housing_types` ON `housing`.housing_type_id = `housing_types`.id LEFT JOIN `bonuses` ON `orders`.id = `bonuses`.order_id WHERE `orders`.id IN (1,2,5);
+------------------+-----------------------------------+----------------+------------------------------------+------------------+-----------------+--------------+---------------+---------------------------+--------------+-------------+-------------------+-------------+
| renter           | title                             | housing_type   | full_address                       | client           | guests_quantity | day_quantity | price_per_day | total_price_without_bonus | bonus_amount | total_price | status            | paid_amount |
+------------------+-----------------------------------+----------------+------------------------------------+------------------+-----------------+--------------+---------------+---------------------------+--------------+-------------+-------------------+-------------+
| Reilly Ferdinand | Vivi un sogno nella camera Deluxe | Замки          | Spain, Barcelona, c.Velazquez, 155 | Reilly Duncan    |               2 |            4 |        172.00 |                    688.00 |         0.00 |      688.00 | Отменён           |       0.000 |
| Freeman Amir     | Роскошное жилье                   | Luxe           | Russia, Kazan, ул. 2-я Вольная     | Garner Noah      |              10 |            7 |        354.00 |                   2478.00 |        82.45 |     2395.55 | Оплачен полностью |    2395.550 |
| Garner Noah      | ???                               | Купольные дома | China, Shanghai, Yunnan            | Reilly Ferdinand |               1 |            2 |        122.00 |                    244.00 |        15.70 |      244.00 | Оплачен частично  |     122.000 |
+------------------+-----------------------------------+----------------+------------------------------------+------------------+-----------------+--------------+---------------+---------------------------+--------------+-------------+-------------------+-------------+
3 rows in set (0.00 sec)

mysql> SELECT `get_price_per_day`(1);
+----------------------+
| get_price_per_day(1) |
+----------------------+
|                    0 |
+----------------------+
1 row in set (0.00 sec)

mysql> SELECT `get_price_per_day`(2);
+----------------------+
| get_price_per_day(2) |
+----------------------+
|              342.221 |
+----------------------+
1 row in set (0.00 sec)

mysql> SELECT `get_price_per_day`(5);
+------------------------+
| `get_price_per_day`(5) |
+------------------------+
|                    122 |
+------------------------+
1 row in set (0.00 sec)

--Действие триггера--
mysql> SELECT * FROM `orders` LEFT JOIN `bonuses` ON `orders`.id = `bonuses`.order_id;
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
| id | housing_id | user_id | guests_quantity | arrival_date | departure_date | day_quantity | total_price_without_bonus | total_price | status            | paid_amount | id   | order_id | status | bonus_amount | created_at          | updated_at          |
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
|  1 |          1 |       3 |               2 | 2021-11-12   | 2021-11-16     |            4 |                    688.00 |      688.00 | Отменён           |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  2 |          2 |       4 |              10 | 2021-11-12   | 2021-11-19     |            7 |                   2478.00 |     2395.55 | Оплачен полностью |    2395.550 |    1 |        2 |      1 |        82.45 | 2021-08-15 12:20:10 | 2021-08-15 12:20:10 |
|  3 |          3 |       5 |               1 | 2021-11-21   | 2021-12-01     |            2 |                     80.00 |       77.00 | Оплачен полностью |      77.000 |    2 |        3 |      1 |         3.00 | 2021-05-24 04:25:10 | 2021-12-03 16:00:10 |
|  4 |          4 |       6 |               1 | 2021-12-20   | 2021-12-25     |            5 |                    630.00 |      630.00 | Забронирован      |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  5 |          5 |       7 |               1 | 2021-12-17   | 2021-12-19     |            2 |                    244.00 |      244.00 | Оплачен частично  |     122.000 |    3 |        5 |      0 |        15.70 | 2021-07-09 00:39:10 | 2021-09-18 00:25:10 |
|  6 |          6 |       8 |               2 | 2021-11-04   | 2021-11-08     |            4 |                    344.00 |      344.00 | Оплачен полностью |     344.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  7 |          7 |       9 |               2 | 2021-10-18   | 2021-10-24     |            6 |                    528.00 |      528.00 | Отменён           |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  8 |          8 |      10 |               5 | 2021-12-09   | 2021-12-16     |            7 |                   1666.00 |     1666.00 | Оплачен полностью |    1666.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  9 |          9 |       1 |               2 | 2021-12-04   | 2021-12-05     |            1 |                    103.00 |      103.00 | Оплачен частично  |      51.500 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
| 10 |         10 |       2 |               7 | 2022-02-01   | 2022-02-03     |            2 |                    504.00 |      504.00 | Забронирован      |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
10 rows in set (0.00 sec)

mysql> UPDATE `bonuses` SET `status` = '1' WHERE `id` = '3';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM `orders` LEFT JOIN `bonuses` ON `orders`.id = `bonuses`.order_id;
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
| id | housing_id | user_id | guests_quantity | arrival_date | departure_date | day_quantity | total_price_without_bonus | total_price | status            | paid_amount | id   | order_id | status | bonus_amount | created_at          | updated_at          |
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
|  1 |          1 |       3 |               2 | 2021-11-12   | 2021-11-16     |            4 |                    688.00 |      688.00 | Отменён           |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  2 |          2 |       4 |              10 | 2021-11-12   | 2021-11-19     |            7 |                   2478.00 |     2395.55 | Оплачен полностью |    2395.550 |    1 |        2 |      1 |        82.45 | 2021-08-15 12:20:10 | 2021-08-15 12:20:10 |
|  3 |          3 |       5 |               1 | 2021-11-21   | 2021-12-01     |            2 |                     80.00 |       77.00 | Оплачен полностью |      77.000 |    2 |        3 |      1 |         3.00 | 2021-05-24 04:25:10 | 2021-12-03 16:00:10 |
|  4 |          4 |       6 |               1 | 2021-12-20   | 2021-12-25     |            5 |                    630.00 |      630.00 | Забронирован      |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  5 |          5 |       7 |               1 | 2021-12-17   | 2021-12-19     |            2 |                    244.00 |      228.30 | Оплачен частично  |     122.000 |    3 |        5 |      1 |        15.70 | 2021-07-09 00:39:10 | 2021-11-20 22:13:37 |
|  6 |          6 |       8 |               2 | 2021-11-04   | 2021-11-08     |            4 |                    344.00 |      344.00 | Оплачен полностью |     344.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  7 |          7 |       9 |               2 | 2021-10-18   | 2021-10-24     |            6 |                    528.00 |      528.00 | Отменён           |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  8 |          8 |      10 |               5 | 2021-12-09   | 2021-12-16     |            7 |                   1666.00 |     1666.00 | Оплачен полностью |    1666.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
|  9 |          9 |       1 |               2 | 2021-12-04   | 2021-12-05     |            1 |                    103.00 |      103.00 | Оплачен частично  |      51.500 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
| 10 |         10 |       2 |               7 | 2022-02-01   | 2022-02-03     |            2 |                    504.00 |      504.00 | Забронирован      |       0.000 | NULL |     NULL |   NULL |         NULL | NULL                | NULL                |
+----+------------+---------+-----------------+--------------+----------------+--------------+---------------------------+-------------+-------------------+-------------+------+----------+--------+--------------+---------------------+---------------------+
10 rows in set (0.00 sec)

mysql> exit;
Bye